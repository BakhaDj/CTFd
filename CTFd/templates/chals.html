{% extends "base.html" %}

{% block stylesheets %}
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/c3/0.4.0/c3.min.css">
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/jquery.isotope/2.2.0/isotope.pkgd.min.js">
    <link rel="stylesheet" href="/static/css/modal.css">
    <link rel="stylesheet" href="/static/css/input.css">
<style>
    .alert {display: none}
    .category-header {text-align: center}
    .challenge-wrapper {padding: 5px}
    .challenge-button {width: 100%}
    .submit-row {padding-top: 0px}
    #submit-key {padding: 10px 20px}
    .disabled-button {background-color: #EEEEEE}

    .file-row {margin: 15px 0px; padding-left: 5px; padding-right: 5px;}
    .file-button {text-decoration: none; color: #fff;}
    .file-button:hover {text-decoration: none; color: #fff;}
    .file-wrapper {padding: 20px; transition: all 0.5s ease; cursor: pointer; color: #fff;}
    .file-button {cursor: pointer;}

    .close-text {color: #ccc;position: relative;top: -25px;right: -15px;cursor: pointer;}
    .chal-desc {padding-left: 40px;padding-right: 40px;}
    .key-submit {padding-top: 14px;}
    .notification-row {padding-left: 45px;padding-right: 45px;}
    .input {padding-right: 30px;}
</style>
{% endblock %}

{% block content %}
<div class="jumbotron home">
    <div class="container">
        <h1>Challenges</h1>
    </div>
</div>
<div class="container main-container">
    <div id='challenges-board' class="row">
    </div>
    <div id="solves-graph" style="width: 90%; height: 400px; margin: 0 auto"></div>
</div>

<div id="chal-window" class="dialog">
    <div class="dialog__overlay"></div>
    <div class="dialog__content">
        <div class="morph-shape">
            <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 560 280" preserveAspectRatio="none">
                <rect x="3" y="3" fill="none" width="556" height="276"/>
            </svg>
        </div>
        <div class="dialog-inner">
            <div class="pull-right"><p class="close-text" data-dialog-close>Close</p></div>
            <div class="row">
                <div role="tabpanel">
                    <ul class="nav nav-tabs" role="tablist">
                        <li role="presentation" class="active"><a href="#challenge" aria-controls="challenge" role="tab">Challenge</a></li>
                        <li role="presentation"><a href="#solves" aria-controls="solves" class="chal-solves" role="tab"></a></li>
                    </ul>
                    <div class="tab-content">
                        <div role="tabpanel" class="tab-pane active" id="challenge">
                            <h3 class='chal-name'></h3>
                            <h4 class="chal-value"></h4>
                            <p class="chal-desc"></p>
                            <div class="chal-files file-row row">
                            </div>

                            <div class="row submit-row">
                                <div class="col-md-9">
                                    <span class="input">
                                        <input class="input-field" type="text" name="answer" id="answer-input" placeholder="Key" />
                                    </span>
                                    <input type="hidden" id="nonce" name="nonce" value={{ nonce }}>
                                    <input id="chal-id" type="hidden">
                                </div>
                                <div class="col-md-3 key-submit">
                                    <button type="submit" id="submit-key" tabindex="5" class="btn btn-md btn-theme btn-outlined pull-right">Submit</button>
                                </div>
                            </div>
                            <div class="row notification-row">
                                <div id="incorrect-key" class="alert alert-danger alert-dismissable" role="alert">
                                  <strong>Incorrect</strong>
                                </div>
                                <div id="correct-key" class="alert alert-success alert-dismissable" role="alert">
                                  <strong>Correct</strong>
                                </div>
                                <div id="already-solved" class="alert alert-info alert-dismissable" role="alert">
                                  <strong>You already solved this</strong>
                                </div>
                                <div id="too-fast" class="alert alert-warning alert-dismissable" role="alert">
                                  <strong>You're submitting keys too fast. Slow down.</strong>
                                </div>
                            </div>
                        </div>
                        <div role="tabpanel" class="tab-pane" id="solves">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <td><b>Name</b>
                                        </td>
                                        <td><b>Date</b>
                                        </td>
                                    </tr>
                                </thead>
                                <tbody id="chal-solves-names">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.5.1/moment.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/c3/0.4.0/c3.min.js"></script>
    <script src="/static/js/chalboard.js"></script>
    <script src="/static/js/classie.js"></script>
    <script src="/static/js/modal.js"></script>
    <script src="/static/js/input.js"></script>
    <script>
    $('[data-dialog-close]').click(function() {
        $('.nav-tabs > li:nth-child(1)').addClass("active");
        $('.nav-tabs > li:nth-child(2)').removeClass("active");
        openDialog.toggle();
        window.location.hash = ""
    });
    </script>
{% endblock %}
